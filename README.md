# CRUD

Бэк для записи, чтения, обновления и удаления информации в БД.

Может использоваться для подключения демонстрационных приложений.

**Адрес**: `<host>/crud/1.0`

## Роуты:
```
POST   /data - Create
GET    /data - Read
PUT    /data - Update
DELETE /data - Delete
```

Сервис работает с Bearer-авторизацией по статичному токену, указанному в `deployment/dev.env`
Чтобы работать только со своими данными, необходимо передавать дополнительно `userId` в query-параметрах с uuidv4 (можно сгенерировать тут: https://www.uuidgenerator.net/). 
`userId` - это просто для получения из базы только своих данных, оно не привязано ни к чему в микросервисе.

На роут `Create` необходимо отправить запрос с любым телом, токеном авторизации и uuid своего пользователя/приложения, которое с этими данными связано.

Роут `Read` может отдавать данные по userId из query (вернёт массив всех значений в БД) или по необязательному `id` также в query-параметрах.

Для роутов `Update` и `Delete` передавать id в query-параметрах обязательно.

## Разработчикам

* `make expand` развернёт приложение на локальной машине, если ранее оно отсутствовало. 

* `make up` - запустить приложение и БД;
* `make down` - остановить приложение и БД (локальная база очищается после остановки);
* если нужно только перезапустить приложение (например, при изменении переменных окружения): нажать `Ctrl+C` и выполнить `make app_down && make app_up && make app_start` 


### Тесты

`make test` - запустить тесты.

Приложение должно быть запущено. При запуске приложения в контейнере БД рядом с локальной базой поднимается тестовая база, которая наполняется в процессе тестирования и очищается после их выполнения.

Если упало с ошибкой **database does not exist** необходимо выполнить `make test_db_create`.
